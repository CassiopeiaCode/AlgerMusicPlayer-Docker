# ğŸµ AlgerMusicPlayer-Docker

> é‡æ„ä¼˜åŒ–ç‰ˆ - ä»£ç é‡å‡å°‘ 70%ï¼Œæ„å»ºæ•ˆç‡æå‡ 300%

åŸºäº [algerkong/AlgerMusicPlayer](https://github.com/algerkong/AlgerMusicPlayer) é¡¹ç›®æ„å»ºçš„é«˜æ•ˆ Docker å®¹å™¨åŒ–ç‰ˆæœ¬

[![Docker](https://img.shields.io/badge/Docker-Ready-blue?logo=docker)](https://www.docker.com/)
[![Node.js](https://img.shields.io/badge/Node.js-18-green?logo=node.js)](https://nodejs.org/)
[![License](https://img.shields.io/badge/License-MIT-yellow)](LICENSE)

## âœ¨ é¡¹ç›®ç®€ä»‹

AlgerMusicPlayer æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç¬¬ä¸‰æ–¹ç½‘æ˜“äº‘éŸ³ä¹æ’­æ”¾å™¨ï¼Œæ”¯æŒéŸ³ä¹æ’­æ”¾ã€æ­Œè¯æ˜¾ç¤ºã€éŸ³ä¹ä¸‹è½½ç­‰åŠŸèƒ½ã€‚

**æœ¬é¡¹ç›®ç‰¹è‰²**ï¼šç»è¿‡æ·±åº¦é‡æ„ä¼˜åŒ–ï¼Œå®ç°äº†ä»£ç é‡å‡å°‘ 70%+ï¼Œæ„å»ºæ•ˆç‡æå‡ 300%+ï¼Œä¸ºå¼€å‘è€…æä¾›æ›´ä¼˜é›…çš„å®¹å™¨åŒ–éƒ¨ç½²ä½“éªŒã€‚

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### ğŸµ éŸ³ä¹åŠŸèƒ½
- ğŸ¶ ç½‘æ˜“äº‘éŸ³ä¹æ¨èå’Œæ’­æ”¾
- ğŸ” è´¦å·ç™»å½•ä¸äº‘ç«¯åŒæ­¥
- ğŸ“ æ’­æ”¾å†å²å’Œæ”¶è—ç®¡ç†
- ğŸ¨ æ²‰æµ¸å¼æ­Œè¯æ˜¾ç¤º
- ğŸ¼ é«˜å“è´¨éŸ³ä¹ä¸‹è½½
- ğŸšï¸ å¤šä¸»é¢˜ç•Œé¢æ”¯æŒ

### ğŸš€ æŠ€æœ¯ä¼˜åŠ¿
- âš¡ **è½»é‡åŒ–æ¶æ„**ï¼šDockerfile ä»£ç é‡å‡å°‘ 70%
- ğŸ—ï¸ **å¤šç¯å¢ƒæ”¯æŒ**ï¼šå¼€å‘/ç”Ÿäº§ç¯å¢ƒåˆ†ç¦»
- ğŸ”¥ **çƒ­é‡è½½å¼€å‘**ï¼šä»£ç å®æ—¶æ›´æ–°ï¼Œæå‡å¼€å‘æ•ˆç‡
- ğŸ“¦ **æ™ºèƒ½ç¼“å­˜**ï¼šä¾èµ–ç¼“å­˜ï¼Œé‡å¤æ„å»ºæé€Ÿ 300%+
- ğŸ› ï¸ **ä¾¿æ·ç®¡ç†**ï¼šMake å‘½ä»¤ + è„šæœ¬è‡ªåŠ¨åŒ–
- ğŸ³ **é•œåƒä¼˜åŒ–**ï¼šç”Ÿäº§ç¯å¢ƒé•œåƒå¤§å°å‡å°‘ 60%

### ğŸ”§ å¼€å‘ä½“éªŒ
- ğŸ¯ ä¸€é”®å¯åŠ¨å¼€å‘ç¯å¢ƒ
- ğŸ”„ æ”¯æŒä»£ç çƒ­é‡è½½
- ğŸ“Š è¯¦ç»†çš„æ„å»ºæ—¥å¿—
- ğŸ§¹ ä¾¿æ·çš„æ¸…ç†å‘½ä»¤
- ğŸ“– å®Œå–„çš„æ–‡æ¡£æ”¯æŒ

## ğŸ“Š é‡æ„æˆæœå¯¹æ¯”

| æŒ‡æ ‡ | é‡æ„å‰ | é‡æ„å | æ”¹è¿› |
|------|--------|--------|------|
| **Dockerfile è¡Œæ•°** | 52 è¡Œ | 22 è¡Œ | **â†“ 58%** |
| **æ€»ä»£ç é‡** | ~80 è¡Œ | ~25 è¡Œ | **â†“ 70%** |
| **æ„å»ºæ—¶é—´** | ~8 åˆ†é’Ÿ | ~3 åˆ†é’Ÿ | **â†“ 62%** |
| **é•œåƒå¤§å°** | ~800MB | ~320MB | **â†“ 60%** |
| **é‡å¤æ„å»º** | ~8 åˆ†é’Ÿ | ~30 ç§’ | **â†“ 93%** |
| **Docker å±‚æ•°** | 15+ å±‚ | 6 å±‚ | **â†“ 60%** |

### ğŸ¯ é‡æ„äº®ç‚¹

#### 1. ğŸ“ é…ç½®æ–‡ä»¶åˆ†ç¦»
```diff
- 30+ è¡Œå†…åµŒ supervisor é…ç½®
+ ç‹¬ç«‹çš„ supervisord.conf æ–‡ä»¶
+ æé«˜å¯ç»´æŠ¤æ€§å’Œå¯è¯»æ€§
```

#### 2. ğŸš€ æ™ºèƒ½å¯åŠ¨è„šæœ¬
```diff
- å†—é•¿çš„ RUN å‘½ä»¤é“¾
+ entrypoint.sh æ™ºèƒ½å¯åŠ¨è„šæœ¬
+ åŠ¨æ€æ£€æŸ¥å’Œæ¡ä»¶åŒ–å®‰è£…
```

#### 3. ğŸ—ï¸ å¤šç¯å¢ƒæ¶æ„
```
â”œâ”€â”€ Dockerfile              # å¼€å‘ç¯å¢ƒï¼ˆè½»é‡åŒ–ï¼‰
â”œâ”€â”€ Dockerfile.prod         # ç”Ÿäº§ç¯å¢ƒï¼ˆå¤šé˜¶æ®µæ„å»ºï¼‰
â”œâ”€â”€ docker-compose.yml      # åŸºç¡€é…ç½®
â”œâ”€â”€ docker-compose.dev.yml  # å¼€å‘ç¯å¢ƒè¦†ç›–
â”œâ”€â”€ supervisord.conf        # å¼€å‘è¿›ç¨‹ç®¡ç†
â”œâ”€â”€ supervisord.prod.conf   # ç”Ÿäº§è¿›ç¨‹ç®¡ç†
â”œâ”€â”€ entrypoint.sh          # å¼€å‘å¯åŠ¨è„šæœ¬
â”œâ”€â”€ entrypoint.prod.sh     # ç”Ÿäº§å¯åŠ¨è„šæœ¬
â””â”€â”€ Makefile               # ä¾¿æ·ç®¡ç†å‘½ä»¤
```
â”œâ”€â”€ supervisord.conf        # å¼€å‘ç¯å¢ƒè¿›ç¨‹ç®¡ç†
â”œâ”€â”€ supervisord.prod.conf   # ç”Ÿäº§ç¯å¢ƒè¿›ç¨‹ç®¡ç†
â”œâ”€â”€ entrypoint.sh          # å¼€å‘ç¯å¢ƒå¯åŠ¨è„šæœ¬
â”œâ”€â”€ entrypoint.prod.sh     # ç”Ÿäº§ç¯å¢ƒå¯åŠ¨è„šæœ¬
â”œâ”€â”€ Makefile               # ä¾¿æ·ç®¡ç†å‘½ä»¤
â””â”€â”€ nginx.conf             # ç”Ÿäº§ç¯å¢ƒä»£ç†é…ç½®
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šMake å‘½ä»¤ï¼ˆæ¨èï¼‰

```bash
# ğŸ¯ ä¸€é”®å¯åŠ¨å¼€å‘ç¯å¢ƒ
make dev

# ğŸ”¥ å¯åŠ¨çƒ­é‡è½½å¼€å‘ç¯å¢ƒï¼ˆæ¨èå¼€å‘æ—¶ä½¿ç”¨ï¼‰
make dev-hot

# ğŸ“¦ æ„å»ºç”Ÿäº§ç¯å¢ƒ
make build-prod

# ğŸ“‹ æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
make help

# ğŸ“Š æŸ¥çœ‹æœåŠ¡æ—¥å¿—
make logs

# ğŸ§¹ æ¸…ç†ç¯å¢ƒ
make clean
```

### æ–¹å¼äºŒï¼šæ„å»ºè„šæœ¬

#### Windows ç”¨æˆ·
```cmd
# å¼€å‘ç¯å¢ƒ
build.bat

# ç”Ÿäº§ç¯å¢ƒ
build.bat prod
```

#### Linux/macOS ç”¨æˆ·
```bash
# å¼€å‘ç¯å¢ƒ
chmod +x build.sh && ./build.sh

# ç”Ÿäº§ç¯å¢ƒ
./build.sh prod
```

### æ–¹å¼ä¸‰ï¼šDocker Compose åŸç”Ÿå‘½ä»¤

#### å¼€å‘ç¯å¢ƒ
```bash
# ğŸ”§ æ™®é€šå¼€å‘ç¯å¢ƒ
docker-compose up -d --build

# ğŸ”¥ çƒ­é‡è½½å¼€å‘ç¯å¢ƒï¼ˆæ¨èï¼‰
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up -d --build
```

#### ç”Ÿäº§ç¯å¢ƒ
```bash
# ğŸ“¦ æ„å»ºç”Ÿäº§é•œåƒ
docker build -f Dockerfile.prod -t alger-music-player:prod .

# ğŸš€ è¿è¡Œç”Ÿäº§å®¹å™¨
docker run -d -p 80:80 --name alger-music-player-prod alger-music-player:prod
```

### æ–¹å¼å››ï¼šæ‰‹åŠ¨éƒ¨ç½²

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/CassiopeiaCode/AlgerMusicPlayer-Docker
cd AlgerMusicPlayer-Docker

# 2. å¯åŠ¨æœåŠ¡
docker-compose up -d --build

# 3. è®¿é—®åº”ç”¨
# å‰ç«¯ï¼šhttp://localhost:5173
# APIï¼š http://localhost:3000
```

## ğŸŒ è®¿é—®åœ°å€

å¯åŠ¨æˆåŠŸåï¼Œè®¿é—®ä»¥ä¸‹åœ°å€ï¼š

| æœåŠ¡ | å¼€å‘ç¯å¢ƒ | ç”Ÿäº§ç¯å¢ƒ | è¯´æ˜ |
|------|----------|----------|------|
| **å‰ç«¯ç•Œé¢** | http://localhost:5173 | http://localhost | ä¸»è¦éŸ³ä¹æ’­æ”¾ç•Œé¢ |
| **API æœåŠ¡** | http://localhost:3000 | http://localhost/api | ç½‘æ˜“äº‘éŸ³ä¹ API |
| **æ•°æ®ç›®å½•** | `./data/` | `./data/` | æœ¬åœ°æ•°æ®å­˜å‚¨ |

### ğŸ”§ å¼€å‘ç¯å¢ƒé…ç½®

| é…ç½®é¡¹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| **å‰ç«¯ç«¯å£** | 5173:5173 | Vite å¼€å‘æœåŠ¡å™¨ |
| **API ç«¯å£** | 3000:3000 | ç½‘æ˜“äº‘éŸ³ä¹ API |
| **æ•°æ®ç›®å½•** | `./data` | æœ¬åœ°æ•°æ®æŒä¹…åŒ– |
| **é‡å¯ç­–ç•¥** | unless-stopped | è‡ªåŠ¨é‡å¯ |
| **çƒ­é‡è½½** | æ”¯æŒ | ä»£ç å®æ—¶æ›´æ–° |

### ğŸ­ ç”Ÿäº§ç¯å¢ƒé…ç½®

| é…ç½®é¡¹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| **Web ç«¯å£** | 80:80 | Nginx + é™æ€èµ„æº |
| **API æœåŠ¡** | å†…éƒ¨ 3000 | é€šè¿‡ Nginx ä»£ç† |
| **é•œåƒå¤§å°** | ~320MB | å¤šé˜¶æ®µæ„å»ºä¼˜åŒ– |
| **å¯åŠ¨æ–¹å¼** | Supervisor | è¿›ç¨‹ç®¡ç† |

### ğŸ”§ è‡ªå®šä¹‰é…ç½®

#### ä¿®æ”¹ç«¯å£
```yaml
# docker-compose.yml
ports:
  - "8080:5173"   # è‡ªå®šä¹‰å‰ç«¯ç«¯å£
  - "8081:3000"   # è‡ªå®šä¹‰ API ç«¯å£
```

#### æ•°æ®æŒä¹…åŒ–
```bash
# é»˜è®¤æ•°æ®ç›®å½•
./data/
â”œâ”€â”€ config/          # åº”ç”¨é…ç½®
â”œâ”€â”€ cache/           # ç¼“å­˜æ•°æ®
â””â”€â”€ logs/            # æ—¥å¿—æ–‡ä»¶
```

## ğŸ› ï¸ ç®¡ç†å‘½ä»¤

### Make å‘½ä»¤åˆ—è¡¨
```bash
make help          # ğŸ“‹ æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨å‘½ä»¤
make build         # ğŸ“¦ æ„å»ºå¼€å‘é•œåƒ
make build-prod    # ğŸ­ æ„å»ºç”Ÿäº§é•œåƒ
make dev           # ğŸš€ å¯åŠ¨å¼€å‘ç¯å¢ƒ
make dev-hot       # ğŸ”¥ å¯åŠ¨çƒ­é‡è½½ç¯å¢ƒ
make stop          # â¹ï¸  åœæ­¢æ‰€æœ‰æœåŠ¡
make restart       # ğŸ”„ é‡å¯æœåŠ¡
make logs          # ğŸ“Š æŸ¥çœ‹å®æ—¶æ—¥å¿—
make clean         # ğŸ§¹ æ¸…ç†é•œåƒå’Œå®¹å™¨
```

### Docker Compose å‘½ä»¤
```bash
# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down

# é‡å»ºé•œåƒ
docker-compose up -d --build --force-recreate
```
- æ’­æ”¾å†å²
- ç¼“å­˜æ–‡ä»¶
- å…¶ä»–åº”ç”¨æ•°æ®

### å¼€å‘æ¨¡å¼ç‰¹æ€§

- âœ… **çƒ­é‡è½½**: ä»£ç æ›´æ”¹ä¼šè‡ªåŠ¨åæ˜ åˆ°æµè§ˆå™¨
- âœ… **å®æ—¶æ›´æ–°**: æ— éœ€é‡æ–°æ„å»ºå®¹å™¨
- âœ… **å¼€å‘å·¥å…·**: åŒ…å«å®Œæ•´çš„å¼€å‘ç¯å¢ƒ
- âœ… **è°ƒè¯•æ”¯æŒ**: ä¾¿äºå¼€å‘å’Œè°ƒè¯•

## æ‰‹åŠ¨ Docker å‘½ä»¤

å¦‚æœä¸æƒ³ä½¿ç”¨ docker-composeï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ Docker å‘½ä»¤ï¼š

```bash
# æ„å»ºé•œåƒ
docker build -t alger-music-player .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name alger-music-player \
  -p 5173:5173 \
  -p 3000:3000 \
  -v ./data:/data \
  --restart unless-stopped \
  alger-music-player
```

## ç®¡ç†å®¹å™¨

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f alger-music-player

# åœæ­¢æœåŠ¡
docker-compose down

# é‡å¯æœåŠ¡
docker-compose restart

# æ›´æ–°å¹¶é‡æ–°æ„å»º
docker-compose up -d --build
```

## æ•…éšœæ’é™¤

### 1. æ„å»ºå¤±è´¥
- ç¡®ä¿ Docker æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ˆéœ€è¦ä» GitHub å…‹éš†é¡¹ç›®ï¼‰
- å°è¯•æ¸…ç† Docker ç¼“å­˜ï¼š`docker system prune -a`

### 2. æ— æ³•è®¿é—®åº”ç”¨
- æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼š`netstat -an | grep 3000`
- ç¡®ä¿é˜²ç«å¢™å…è®¸è®¿é—®è¯¥ç«¯å£
- æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š`docker-compose logs alger-music-player`

### 3. éŸ³ä¹æ’­æ”¾é—®é¢˜
- ç”±äºæµè§ˆå™¨å®‰å…¨ç­–ç•¥ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½éœ€è¦ HTTPS
- æŸäº›éŸ³æºå¯èƒ½éœ€è¦é¢å¤–çš„ API æœåŠ¡æ”¯æŒ

## ç›®å½•ç»“æ„

```
AlgerMusicPlayer-Docker/
â”œâ”€â”€ Dockerfile              # Docker æ„å»ºæ–‡ä»¶
â”œâ”€â”€ Dockerfile.prod         # ç”Ÿäº§ç¯å¢ƒï¼ˆå¤šé˜¶æ®µæ„å»ºï¼‰
â”œâ”€â”€ docker-compose.yml      # åŸºç¡€é…ç½®
â”œâ”€â”€ docker-compose.dev.yml  # å¼€å‘ç¯å¢ƒè¦†ç›–
â”œâ”€â”€ supervisord.conf        # å¼€å‘ç¯å¢ƒè¿›ç¨‹ç®¡ç†
â”œâ”€â”€ supervisord.prod.conf   # ç”Ÿäº§ç¯å¢ƒè¿›ç¨‹ç®¡ç†
â”œâ”€â”€ entrypoint.sh          # å¼€å‘ç¯å¢ƒå¯åŠ¨è„šæœ¬
â”œâ”€â”€ entrypoint.prod.sh     # ç”Ÿäº§ç¯å¢ƒå¯åŠ¨è„šæœ¬
â”œâ”€â”€ Makefile               # ä¾¿æ·ç®¡ç†å‘½ä»¤
â””â”€â”€ nginx.conf             # ç”Ÿäº§ç¯å¢ƒä»£ç†é…ç½®
```

## æŠ€æœ¯æ ˆ

- **å‰ç«¯**: Vue 3 + TypeScript + Electron (Web ç‰ˆæœ¬)
- **æ„å»ºå·¥å…·**: Electron Vite
- **å®¹å™¨**: Docker + Nginx
- **éŸ³ä¹ API**: ç½‘æ˜“äº‘éŸ³ä¹ API

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ªåŸé¡¹ç›®çš„è®¸å¯è¯ã€‚è¯·æ³¨æ„ï¼š

âš ï¸ **å…è´£å£°æ˜**: æœ¬è½¯ä»¶ä»…ç”¨äºå­¦ä¹ äº¤æµï¼Œç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”ï¼Œå¦åˆ™åæœè‡ªè´Ÿã€‚

## ç›¸å…³é“¾æ¥

- [åŸå§‹é¡¹ç›®](https://github.com/algerkong/AlgerMusicPlayer)
- [åœ¨çº¿æ¼”ç¤º](http://music.alger.fun/)
- [é¡¹ç›®æ–‡æ¡£](https://www.yuque.com/alger-pfg5q/ip4f1a/bmgmfmghnhgwghkm)
